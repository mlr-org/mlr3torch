<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="mlr3torch">
<title>Image Classification • mlr3torch</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.7/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.7/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.7/font.css" rel="stylesheet">
<!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Image Classification">
<meta property="og:description" content="mlr3torch">
<meta property="og:image" content="https://mlr3torch.mlr-org.com/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mlr3torch</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/get_started.html">Get Started</a>
    <a class="dropdown-item" href="../articles/image_classification.html">Image Classification</a>
    <a class="dropdown-item" href="../articles/pipeop_torch.html">Neural Networks as Graphs</a>
  </div>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr3book.mlr-org.com">
    <span class="fa fa fa fa-link"></span>
     
    mlr3book
  </a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/mlr-org/mlr3torch">
    <span class="fa fa fa fa-github"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Image Classification</h1>
            
      
      
      <div class="d-none name"><code>image_classification.Rmd</code></div>
    </div>

    
    
<p>In the <em>Get Started</em> vignette, we have already explained how
to train a simple neural network on tabular data. In this article we
will briefly cover how to work with image data. In
<code>mlr3torch</code>, image data is represented using the
<code><a href="../reference/imageuri.html">mlr3torch::imageuri</a></code> class. It is essentially a character
vector, containing paths to images on the file system. When listing the
available task feature types (after loading the <code>mlr3torch</code>
package), we can see that this class is available.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">mlr3torch</span><span class="op">)</span></span>
<span><span class="va">mlr_reflections</span><span class="op">$</span><span class="va">task_feature_types</span></span>
<span><span class="co">#&gt;         lgl         int         dbl         chr         fct         ord </span></span>
<span><span class="co">#&gt;   "logical"   "integer"   "numeric" "character"    "factor"   "ordered" </span></span>
<span><span class="co">#&gt;         pxc         img </span></span>
<span><span class="co">#&gt;   "POSIXct"  "imageuri"</span></span></code></pre></div>
<p>Creating a vector (in this case of length 1) is as simple as passing
the image paths to the <code><a href="../reference/imageuri.html">imageuri()</a></code> function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">image_vec</span> <span class="op">=</span> <span class="fu"><a href="../reference/imageuri.html">imageuri</a></span><span class="op">(</span><span class="st">"/path/to/your/image"</span><span class="op">)</span></span></code></pre></div>
<p>For the processing of images, <code>mlr3torch</code> relies mostly on
the functionality provided by <a href="https://github.com/mlverse/torchvision" class="external-link"><code>torchvision</code></a>.
As an example task, we will use the “tiny imagenet” dataset, which is a
subset of the <a href="http://www.image-net.org/" class="external-link">ImageNet</a> dataset.
It consists of 200 classes with 500 training images each. The goal is to
predict the class of an image from the pixels. For more information you
can access the tasks’s help page by calling <code>$help()</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsk_tiny</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">tsk</a></span><span class="op">(</span><span class="st">"tiny_imagenet"</span><span class="op">)</span></span>
<span><span class="va">tsk_tiny</span></span>
<span><span class="co">#&gt; &lt;TaskClassif:tiny_imagenet&gt; (100000 x 2): ImageNet Subset</span></span>
<span><span class="co">#&gt; * Target: class</span></span>
<span><span class="co">#&gt; * Properties: multiclass</span></span>
<span><span class="co">#&gt; * Features (1):</span></span>
<span><span class="co">#&gt;   - img (1): image</span></span></code></pre></div>
<p>The first time this task is accessed, the data is downloaded from the
internet. In order to download the dataset only once, you can set the
<code>mlr3torch.cache</code> option to either <code>TRUE</code> or a
specific path to be used as the cache folder.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>mlr3torch.cache <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Below, we print the path to the first image as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tsk_tiny</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span><span class="fl">1</span>, <span class="st">"image"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Downloding tiny imagenet dataset!</span></span>
<span><span class="co">#&gt; Download complete. Now unzipping.</span></span>
<span><span class="co">#&gt; Done!</span></span>
<span><span class="co">#&gt;                                                                                                                   image</span></span>
<span><span class="co">#&gt; 1: /home/runner/.cache/R/mlr3torch/datasets/tiny_imagenet/raw/tiny-imagenet-200/train/n01443537/images/n01443537_0.JPEG</span></span></code></pre></div>
<p>To work with such data, we need to use learners that have
<code>"imageuri"</code> as part of their supported feature types. One
such learner is the famous AlexNet classification network, which sparked
the “Deep Learning revolution” in 2012.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">alexnet</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/mlr_sugar.html" class="external-link">lrn</a></span><span class="op">(</span><span class="st">"classif.alexnet"</span><span class="op">)</span></span>
<span><span class="va">alexnet</span></span>
<span><span class="co">#&gt; &lt;LearnerTorchAlexNet[classif]:classif.alexnet&gt;: AlexNet Image Classifier</span></span>
<span><span class="co">#&gt; * Model: -</span></span>
<span><span class="co">#&gt; * Optimizer: adam</span></span>
<span><span class="co">#&gt; * Loss: cross_entropy</span></span>
<span><span class="co">#&gt; * Callbacks: -</span></span>
<span><span class="co">#&gt; * Parameters: pretrained=TRUE, device=auto, measures_train=&lt;list&gt;,</span></span>
<span><span class="co">#&gt;   measures_valid=&lt;list&gt;, num_threads=1, drop_last=FALSE, shuffle=TRUE,</span></span>
<span><span class="co">#&gt;   seed=random</span></span>
<span><span class="co">#&gt; * Packages: mlr3, mlr3torch, torchvision, magick, torch</span></span>
<span><span class="co">#&gt; * Predict Types:  [response], prob</span></span>
<span><span class="co">#&gt; * Feature Types: imageuri</span></span>
<span><span class="co">#&gt; * Properties: multiclass, twoclass</span></span></code></pre></div>
<p>We could now train this learner like any other learner on the task at
hand, while <code>mlr3torch</code> internally creates a dataloader from
the image paths. We could also download and use predefined weights, by
specifying the <code>pretrained</code> parameter to <code>TRUE</code>.
For computational reasons, we cannot demonstrate the actual training of
the learner in this article.</p>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Sebastian Fischer, Martin Binder.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
