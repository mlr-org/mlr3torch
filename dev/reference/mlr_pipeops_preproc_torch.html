<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Base Class for Lazy Tensor Preprocessing — mlr_pipeops_preproc_torch • mlr3torch</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="../deps/MathJax-3.2.2/tex-chtml.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Base Class for Lazy Tensor Preprocessing — mlr_pipeops_preproc_torch"><meta name="description" content="This PipeOp can be used to preprocess (one or more) lazy_tensor columns contained in an mlr3::Task.
The preprocessing function is specified as construction argument fn and additional arguments to this
function can be defined through the PipeOp's parameter set.
The preprocessing is done per column, i.e. the number of lazy tensor output columns is equal
to the number of lazy tensor input columns.
To create custom preprocessing PipeOps you can use pipeop_preproc_torch."><meta property="og:description" content="This PipeOp can be used to preprocess (one or more) lazy_tensor columns contained in an mlr3::Task.
The preprocessing function is specified as construction argument fn and additional arguments to this
function can be defined through the PipeOp's parameter set.
The preprocessing is done per column, i.e. the number of lazy tensor output columns is equal
to the number of lazy tensor input columns.
To create custom preprocessing PipeOps you can use pipeop_preproc_torch."><meta property="og:image" content="https://mlr3torch.mlr-org.com/logo.svg"><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">mlr3torch</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.1.2-9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-file-alt"></span> Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/callbacks.html">Custom Callbacks</a></li>
    <li><a class="dropdown-item" href="../articles/get_started.html">Get Started</a></li>
    <li><a class="dropdown-item" href="../articles/internals_pipeop_torch.html">Internals</a></li>
    <li><a class="dropdown-item" href="../articles/lazy_tensor.html">Lazy Tensor</a></li>
    <li><a class="dropdown-item" href="../articles/pipeop_torch.html">Defining an Architecture</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr3book.mlr-org.com"><span class="fa fa-link"></span> mlr3book</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mlr-org/mlr3torch"><span class="fa fa-github"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/"><span class="fa fa-comments"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3"><span class="fa fab fa-stack-overflow"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://mlr-org.com/"><span class="fa fa-rss"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Base Class for Lazy Tensor Preprocessing</h1>
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr3torch/blob/main/R/PipeOpTaskPreprocTorch.R" class="external-link"><code>R/PipeOpTaskPreprocTorch.R</code></a></small>
      <div class="d-none name"><code>mlr_pipeops_preproc_torch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This <code>PipeOp</code> can be used to preprocess (one or more) <code><a href="lazy_tensor.html">lazy_tensor</a></code> columns contained in an <code><a href="https://mlr3.mlr-org.com/reference/Task.html" class="external-link">mlr3::Task</a></code>.
The preprocessing function is specified as construction argument <code>fn</code> and additional arguments to this
function can be defined through the <code>PipeOp</code>'s parameter set.
The preprocessing is done per column, i.e. the number of lazy tensor output columns is equal
to the number of lazy tensor input columns.</p>
<p>To create custom preprocessing <code>PipeOp</code>s you can use <code><a href="pipeop_preproc_torch.html">pipeop_preproc_torch</a></code>.</p>
    </div>


    <div class="section level2">
    <h2 id="inheriting">Inheriting<a class="anchor" aria-label="anchor" href="#inheriting"></a></h2>


<p>In addition to specifying the construction arguments, you can overwrite the private <code>.shapes_out()</code> method.
If you don't overwrite it, the output shapes are assumed to be unknown (<code>NULL</code>).</p><ul><li><p><code>.shapes_out(shapes_in, param_vals, task)</code><br>
(<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>, <code>list(), </code>Task<code>or</code>NULL<code>) -&gt; </code>list()<code>\cr This private method calculates the output shapes of the lazy tensor columns that are created from applying the preprocessing function with the provided parameter values (</code>param_vals<code>). The </code>task<code>is very rarely needed, but if it is it should be checked that it is not</code>NULL`.</p>
<p>This private method only has the responsibility to calculate the output shapes for one input column, i.e. the
input <code>shapes_in</code> can be assumed to have exactly one shape vector for which it must calculate the output shapes
and return it as a <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of length 1.
It can also be assumed that the shape is not <code>NULL</code> (i.e. unknown).
Also, the first dimension can be <code>NA</code>, i.e. is unknown (as for the batch dimension).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="input-and-output-channels">Input and Output Channels<a class="anchor" aria-label="anchor" href="#input-and-output-channels"></a></h2>


<p>See <code><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOpTaskPreproc.html" class="external-link">PipeOpTaskPreproc</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="state">State<a class="anchor" aria-label="anchor" href="#state"></a></h2>


<p>In addition to state elements from <code><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOpTaskPreprocSimple.html" class="external-link">PipeOpTaskPreprocSimple</a></code>,
the state also contains the <code>$param_vals</code> that were set during training.</p>
    </div>
    <div class="section level2">
    <h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a></h2>


<p>In addition to the parameters inherited from <code><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOpTaskPreproc.html" class="external-link">PipeOpTaskPreproc</a></code> as well as those specified during construction
as the argument <code>param_set</code> there are the following parameters:</p><ul><li><p><code>stages</code> :: <code>character(1)</code><br>
The stages during which to apply the preprocessing.
Can be one of <code>"train"</code>, <code>"predict"</code> or <code>"both"</code>.
The initial value of this parameter is set to <code>"train"</code> when the <code>PipeOp</code>'s id starts with <code>"augment_"</code> and
to <code>"both"</code> otherwise.
Note that the preprocessing that is applied during <code>$predict()</code> uses the parameters that were set during
<code>$train()</code> and not those that are set when performing the prediction.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="internals">Internals<a class="anchor" aria-label="anchor" href="#internals"></a></h2>


<p>During <code>$train()</code> / <code>$predict()</code>, a <code><a href="mlr_pipeops_module.html">PipeOpModule</a></code> with one input and one output channel is created.
The pipeop applies the function <code>fn</code> to the input tensor while additionally
passing the parameter values (minus <code>stages</code> and <code>affect_columns</code>) to <code>fn</code>.
The preprocessing graph of the lazy tensor columns is shallowly cloned and the <code>PipeOpModule</code> is added.
This is done to avoid modifying user input and means that identical <code>PipeOpModule</code>s can be part of different
preprocessing graphs. This is only possible, because the created <code>PipeOpModule</code> is stateless.</p>
<p>At a later point in the graph, preprocessing graphs will be merged if possible to avoid unnecessary computation.
This is best illustrated by example:
One lazy tensor column's preprocessing graph is <code>A -&gt; B</code>.
Then, two branches are created <code>B -&gt; C</code> and <code>B -&gt; D</code>, creating two preprocessing graphs
<code>A -&gt; B -&gt; C</code> and <code>A -&gt; B -&gt; D</code>. When loading the data, we want to run the preprocessing only once, i.e. we don't
want to run the <code>A -&gt; B</code> part twice. For this reason, <code><a href="task_dataset.html">task_dataset()</a></code> will try to merge graphs and cache
results from graphs. However, only graphs using the same dataset can currently be merged.</p>
<p>Also, the shapes created during <code>$train()</code> and <code>$predict()</code> might differ.
To avoid the creation of graphs where the predict shapes are incompatible with the train shapes,
the hypothetical predict shapes are already calculated during <code>$train()</code> (this is why the parameters that are set
during train are also used during predict) and the <code><a href="mlr_pipeops_torch_model.html">PipeOpTorchModel</a></code> will check the train and predict shapes for
compatibility before starting the training.</p>
<p>Otherwise, this mechanism is very similar to the <code><a href="ModelDescriptor.html">ModelDescriptor</a></code> construct.</p>
    </div>
    <div class="section level2">
    <h2 id="super-classes">Super classes<a class="anchor" aria-label="anchor" href="#super-classes"></a></h2>
    <p><code><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOp.html" class="external-link">mlr3pipelines::PipeOp</a></code> -&gt; <code><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOpTaskPreproc.html" class="external-link">mlr3pipelines::PipeOpTaskPreproc</a></code> -&gt; <code>PipeOpTaskPreprocTorch</code></p>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>fn</code></dt>
<dd><p>The preprocessing function.</p></dd>


<dt><code>rowwise</code></dt>
<dd><p>Whether the preprocessing is applied rowwise.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>

<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-PipeOpTaskPreprocTorch-new"><code>PipeOpTaskPreprocTorch$new()</code></a></p></li>
<li><p><a href="#method-PipeOpTaskPreprocTorch-shapes_out"><code>PipeOpTaskPreprocTorch$shapes_out()</code></a></p></li>
<li><p><a href="#method-PipeOpTaskPreprocTorch-clone"><code>PipeOpTaskPreprocTorch$clone()</code></a></p></li>
</ul></div><p><details open><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="mlr3pipelines" data-topic="PipeOp" data-id="help"><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOp.html#method-help"><code>mlr3pipelines::PipeOp$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3pipelines" data-topic="PipeOp" data-id="predict"><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOp.html#method-predict"><code>mlr3pipelines::PipeOp$predict()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3pipelines" data-topic="PipeOp" data-id="print"><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOp.html#method-print"><code>mlr3pipelines::PipeOp$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3pipelines" data-topic="PipeOp" data-id="train"><a href="https://mlr3pipelines.mlr-org.com/reference/PipeOp.html#method-train"><code>mlr3pipelines::PipeOp$train()</code></a></span></li>
</ul></details></p><hr><a id="method-PipeOpTaskPreprocTorch-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates a new instance of this <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a></code> class.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/mlr_pipeops_preproc_torch.html">PipeOpTaskPreprocTorch</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">fn</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"preproc_torch"</span>,</span>
<span>  param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  param_set <span class="op">=</span> <span class="fu">ps</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  rowwise <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  stages_init <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tags <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>fn</code></dt>
<dd><p>(<code>function</code> or <code>character(2)</code>)<br>
The preprocessing function. Must not modify its input in-place.
If it is a <code>character(2)</code>, the first element should be the namespace and the second element the name.
When the preprocessing function is applied to the tensor, the tensor will be passed by position as the first argument.
If the <code>param_set</code> is inferred (left as <code>NULL</code>) it is assumed that the first argument is the <code>torch_tensor</code>.</p></dd>


<dt><code>id</code></dt>
<dd><p>(<code>character(1)</code>)<br>
The id for of the new object.</p></dd>


<dt><code>param_vals</code></dt>
<dd><p>(named <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>)<br>
Parameter values to be set after construction.</p></dd>


<dt><code>param_set</code></dt>
<dd><p>(<code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">ParamSet</a></code>)<br>
In case the function <code>fn</code> takes additional parameter besides a <code><a href="https://rdrr.io/pkg/torch/man/torch_tensor.html" class="external-link">torch_tensor</a></code> they can be
specfied as parameters. None of the parameters can have the <code>"predict"</code> tag.
All tags should include <code>"train"</code>.</p></dd>


<dt><code>packages</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
The packages the preprocessing function depends on.</p></dd>


<dt><code>rowwise</code></dt>
<dd><p>(<code>logical(1)</code>)<br>
Whether the preprocessing function is applied rowwise (and then concatenated by row) or directly to the whole
tensor. In the first case there is no batch dimension.</p></dd>


<dt><code>stages_init</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Initial value for the <code>stages</code> parameter.</p></dd>


<dt><code>tags</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
Tags for the pipeop.</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-PipeOpTaskPreprocTorch-shapes_out"></a><div class="section">
<h3 id="method-shapes-out-">Method <code>shapes_out()</code><a class="anchor" aria-label="anchor" href="#method-shapes-out-"></a></h3>
<p>Calculates the output shapes that would result in applying the preprocessing to one or more
lazy tensor columns with the provided shape.
Names are ignored and only order matters.
It uses the parameter values that are currently set.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PipeOpTaskPreprocTorch</span><span class="op">$</span><span class="fu">shapes_out</span><span class="op">(</span><span class="va">shapes_in</span>, stage <span class="op">=</span> <span class="cn">NULL</span>, task <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>shapes_in</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of (<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or <code>NULL</code>))<br>
The input input shapes of the lazy tensors.
<code>NULL</code> indicates that the shape is unknown.
First dimension must be <code>NA</code> (if it is not <code>NULL</code>).</p></dd>


<dt><code>stage</code></dt>
<dd><p>(<code>character(1)</code>)<br>
The stage: either <code>"train"</code> or <code>"predict"</code>.</p></dd>


<dt><code>task</code></dt>
<dd><p>(<code><a href="https://mlr3.mlr-org.com/reference/Task.html" class="external-link">Task</a></code> or <code>NULL</code>)<br>
The task, which is very rarely needed.</p></dd>


</dl><p></p></div>
</div>
<div class="section">
<h4 id="returns">Returns<a class="anchor" aria-label="anchor" href="#returns"></a></h4>
<p><code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of (<code><a href="https://rdrr.io/r/base/integer.html" class="external-link">integer()</a></code> or <code>NULL</code>)</p>
</div>

</div><p></p><hr><a id="method-PipeOpTaskPreprocTorch-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-2">Usage<a class="anchor" aria-label="anchor" href="#usage-2"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">PipeOpTaskPreprocTorch</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-2">Arguments<a class="anchor" aria-label="anchor" href="#arguments-2"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Creating a simple task</span></span></span>
<span class="r-in"><span><span class="va">d</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/data.table/man/data.table.html" class="external-link">data.table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x1 <span class="op">=</span> <span class="fu"><a href="as_lazy_tensor.html">as_lazy_tensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x2 <span class="op">=</span> <span class="fu"><a href="as_lazy_tensor.html">as_lazy_tensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  x3 <span class="op">=</span> <span class="fu"><a href="as_lazy_tensor.html">as_lazy_tensor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/double.html" class="external-link">as.double</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">taskin</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3.mlr-org.com/reference/as_task_regr.html" class="external-link">as_task_regr</a></span><span class="op">(</span><span class="va">d</span>, target <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Creating a simple preprocessing pipeop</span></span></span>
<span class="r-in"><span><span class="va">po_simple</span> <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/po.html" class="external-link">po</a></span><span class="op">(</span><span class="st">"preproc_torch"</span>,</span></span>
<span class="r-in"><span>  <span class="co"># get rid of environment baggage</span></span></span>
<span class="r-in"><span>  fn <span class="op">=</span> <span class="fu">mlr3misc</span><span class="fu">::</span><span class="fu"><a href="https://mlr3misc.mlr-org.com/reference/crate.html" class="external-link">crate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">a</span><span class="op">)</span> <span class="va">x</span> <span class="op">+</span> <span class="va">a</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  param_set <span class="op">=</span> <span class="fu">paradox</span><span class="fu">::</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html" class="external-link">ps</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu">paradox</span><span class="fu">::</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_int</a></span><span class="op">(</span>tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"train"</span>, <span class="st">"required"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">po_simple</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">set_values</span><span class="op">(</span></span></span>
<span class="r-in"><span>  a <span class="op">=</span> <span class="fl">100</span>,</span></span>
<span class="r-in"><span>  affect_columns <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/Selector.html" class="external-link">selector_name</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  stages <span class="op">=</span> <span class="st">"both"</span> <span class="co"># use during train and predict</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">taskout_train</span> <span class="op">=</span> <span class="va">po_simple</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">taskin</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="materialize.html">materialize</a></span><span class="op">(</span><span class="va">taskout_train</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span>, rbind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.6242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.3046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.0469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.7928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.3490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.2591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.1940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.1057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.6664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,1} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.6418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.3561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.5870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.8496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98.2892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.4310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97.3548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98.9675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,1} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">taskout_predict_noaug</span> <span class="op">=</span> <span class="va">po_simple</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">taskin</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="materialize.html">materialize</a></span><span class="op">(</span><span class="va">taskout_predict_noaug</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span>, rbind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.6242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.3046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.0469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.7928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.3490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.2591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.1940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.1057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.6664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,1} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.6418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.3561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.5870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.8496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98.2892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.4310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97.3548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98.9675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,1} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">po_simple</span><span class="op">$</span><span class="va">param_set</span><span class="op">$</span><span class="fu">set_values</span><span class="op">(</span></span></span>
<span class="r-in"><span>  stages <span class="op">=</span> <span class="st">"train"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># transformation is not applied</span></span></span>
<span class="r-in"><span><span class="va">taskout_predict_aug</span> <span class="op">=</span> <span class="va">po_simple</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">taskin</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="materialize.html">materialize</a></span><span class="op">(</span><span class="va">taskout_predict_aug</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span>, rbind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.6242</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.3046</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2164</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.0469</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.7928</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.3490</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.2591</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.1940</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.1057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.6664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,1} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.6418</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.3561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  100.5870</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.8496</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98.2892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  101.4310</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   97.3548</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   98.9675</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2925</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   99.2994</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,1} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Creating a more complex preprocessing PipeOp</span></span></span>
<span class="r-in"><span><span class="va">PipeOpPreprocTorchPoly</span> <span class="op">=</span> <span class="fu">R6</span><span class="fu">::</span><span class="kw"><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></span><span class="op">(</span><span class="st">"PipeOpPreprocTorchPoly"</span>,</span></span>
<span class="r-in"><span> inherit <span class="op">=</span> <span class="va">PipeOpTaskPreprocTorch</span>,</span></span>
<span class="r-in"><span> public <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   initialize <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">id</span> <span class="op">=</span> <span class="st">"preproc_poly"</span>, <span class="va">param_vals</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="va">param_set</span> <span class="op">=</span> <span class="fu">paradox</span><span class="fu">::</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/ps.html" class="external-link">ps</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>       n_degree <span class="op">=</span> <span class="fu">paradox</span><span class="fu">::</span><span class="fu"><a href="https://paradox.mlr-org.com/reference/Domain.html" class="external-link">p_int</a></span><span class="op">(</span>lower <span class="op">=</span> <span class="fl">1L</span>, tags <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"train"</span>, <span class="st">"required"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">param_set</span><span class="op">$</span><span class="fu">set_values</span><span class="op">(</span></span></span>
<span class="r-in"><span>       n_degree <span class="op">=</span> <span class="fl">1L</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="va">fn</span> <span class="op">=</span> <span class="fu">mlr3misc</span><span class="fu">::</span><span class="fu"><a href="https://mlr3misc.mlr-org.com/reference/crate.html" class="external-link">crate</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">n_degree</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>       <span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/torch_cat.html" class="external-link">torch_cat</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>         <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="va">n_degree</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">d</span><span class="op">)</span> <span class="fu">torch</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/torch/man/torch_pow.html" class="external-link">torch_pow</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">d</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>         dim <span class="op">=</span> <span class="fl">2L</span></span></span>
<span class="r-in"><span>       <span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>     <span class="va">super</span><span class="op">$</span><span class="fu">initialize</span><span class="op">(</span></span></span>
<span class="r-in"><span>       fn <span class="op">=</span> <span class="va">fn</span>,</span></span>
<span class="r-in"><span>       id <span class="op">=</span> <span class="va">id</span>,</span></span>
<span class="r-in"><span>       packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>       param_vals <span class="op">=</span> <span class="va">param_vals</span>,</span></span>
<span class="r-in"><span>       param_set <span class="op">=</span> <span class="va">param_set</span>,</span></span>
<span class="r-in"><span>       stages_init <span class="op">=</span> <span class="st">"both"</span></span></span>
<span class="r-in"><span>     <span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">}</span></span></span>
<span class="r-in"><span> <span class="op">)</span>,</span></span>
<span class="r-in"><span> private <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>   .shapes_out <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">shapes_in</span>, <span class="va">param_vals</span>, <span class="va">task</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>     <span class="co"># shapes_in is a list of length 1 containing the shapes</span></span></span>
<span class="r-in"><span>     <span class="fu">checkmate</span><span class="fu">::</span><span class="fu"><a href="https://mllg.github.io/checkmate/reference/checkTRUE.html" class="external-link">assert_true</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">shapes_in</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">==</span> <span class="fl">2L</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="kw">if</span> <span class="op">(</span><span class="va">shapes_in</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fl">2L</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">1L</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>       <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"Input shape must be (NA, 1)"</span><span class="op">)</span></span></span>
<span class="r-in"><span>     <span class="op">}</span></span></span>
<span class="r-in"><span>     <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">param_vals</span><span class="op">$</span><span class="va">n_degree</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>   <span class="op">}</span></span></span>
<span class="r-in"><span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">po_poly</span> <span class="op">=</span> <span class="va">PipeOpPreprocTorchPoly</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span></span>
<span class="r-in"><span>  param_vals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>n_degree <span class="op">=</span> <span class="fl">3L</span>, affect_columns <span class="op">=</span> <span class="fu"><a href="https://mlr3pipelines.mlr-org.com/reference/Selector.html" class="external-link">selector_name</a></span><span class="op">(</span><span class="st">"x3"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">po_poly</span><span class="op">$</span><span class="fu">shapes_out</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">1L</span><span class="op">)</span><span class="op">)</span>, stage <span class="op">=</span> <span class="st">"train"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [[1]]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA  3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">taskout</span> <span class="op">=</span> <span class="va">po_poly</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">taskin</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="materialize.html">materialize</a></span><span class="op">(</span><span class="va">taskout</span><span class="op">$</span><span class="fu">data</span><span class="op">(</span>cols <span class="op">=</span> <span class="st">"x3"</span><span class="op">)</span>, rbind <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $x3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> torch_tensor</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     1     1     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2     4     8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     3     9    27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     4    16    64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     5    25   125</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     6    36   216</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     7    49   343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     8    64   512</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     9    81   729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    10   100  1000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [ CPUFloatType{10,3} ]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Fischer, Martin Binder.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

