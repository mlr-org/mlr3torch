<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This base class provides the basic functionality for training and prediction of a neural network.
All torch regression learners should inherit from the respective subclass."><title>Abstract Base Class for a Torch Regression Learner — mlr_learners_regr.torch • mlr3torch</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.6/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.6/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.6/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Abstract Base Class for a Torch Regression Learner — mlr_learners_regr.torch"><meta property="og:description" content="This base class provides the basic functionality for training and prediction of a neural network.
All torch regression learners should inherit from the respective subclass."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">mlr3torch</a>

    <small class="nav-text text-default me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">
    <span class="fa fa fa fa-file-alt"></span>
     
    Reference
  </a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://mlr3book.mlr-org.com">
    <span class="fa fa fa fa-link"></span>
     
    mlr3book
  </a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://stackoverflow.com/questions/tagged/mlr3">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Abstract Base Class for a Torch Regression Learner</h1>
      
      <div class="d-none name"><code>mlr_learners_regr.torch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This base class provides the basic functionality for training and prediction of a neural network.
All torch regression learners should inherit from the respective subclass.</p>
    </div>


    <div class="section level2">
    <h2 id="state">State<a class="anchor" aria-label="anchor" href="#state"></a></h2>
    

<p>The state is a list with elements <code>network</code>, <code>optimizer</code>, <code>loss_fn</code> and <code>callbacks</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a></h2>
    

<ul><li><p><code>batch_size</code> :: (<code>integer(1)</code>)<br>
The batch size.</p></li>
<li><p><code>epochs</code> :: <code>integer(1)</code><br>
The number of epochs.</p></li>
<li><p><code>device</code> :: <code>character(1)</code><br>
The device. One of <code>"auto"</code>, <code>"cpu"</code>, or <code>"cuda"</code>.</p></li>
<li><p><code>measures_train</code> :: <code>Measure</code> or <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of <code>Measure</code>s.
Measures to be evaluated during training.</p></li>
<li><p><code>measures_valid</code> :: <code>Measure</code> or <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of <code>Measure</code>s.
Measures to be evaluated during validation.</p></li>
<li><p><code>drop_last</code> :: <code>logical(1)</code><br>
Whether to drop the last batch in each epoch during training. Default is <code>FALSE</code>.</p></li>
<li><p><code>num_threads</code> :: <code>integer(1)</code><br>
The number of threads (if <code>device</code> is <code>"cpu"</code>). Default is 1.</p></li>
<li><p><code>shuffle</code> :: <code>logical(1)</code><br>
Whether to shuffle the instances in the dataset. Default is <code>TRUE</code>.</p></li>
<li><p><code>early_stopping_rounds</code> :: <code>integer(1)</code><br>
How many rounds to wait for early stopping. The default is 0.</p></li>
<li><p><code>seed</code> :: <code>integer(1)</code><br>
The seed that is used during training. The value <code>seed + 1</code> is used during prediction.
If this is missing (default), a random seed is generated.</p></li>
</ul><p>Additionally there are the parameters for the optimizer, the loss function and the callbacks.
They are prefixed with <code>"opt."</code>, <code>"loss."</code> and <code>"cb.&lt;callback id&gt;."</code> respectively.</p>
    </div>
    <div class="section level2">
    <h2 id="inheriting">Inheriting<a class="anchor" aria-label="anchor" href="#inheriting"></a></h2>
    

<p>When inheriting from this class, one should overload two private methods:</p><ul><li><p><code>.network(task, param_vals)</code><br>
(<code>Task</code>, <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>) -&gt; <code>nn_module</code><br>
Construct a <code><a href="https://rdrr.io/pkg/torch/man/nn_module.html" class="external-link">torch::nn_module</a></code> object for the given task and parameter values, i.e. the neural network that
is trained by the learner.
For classification, the output of this network are expected to be the scores before the application of the
final softmax layer.</p></li>
<li><p><code>.dataset(task, param_vals)</code><br>
(<code>Task</code>, <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>) -&gt; <code><a href="https://rdrr.io/pkg/torch/man/dataset.html" class="external-link">torch::dataset</a></code><br>
Create the dataset for the task.  Must at least respect parameters <code>batch_size</code> and <code>shuffle</code>.</p></li>
</ul><p>It is also possible to overwrite the private <code>.dataloader()</code> method instead of the <code>.dataset()</code> method.
Per default, a dataloader is constructed using the output from the <code>.dataset()</code> method.</p><ul><li><p><code>.dataloader(task, param_vals)</code><br>
(<code>Task</code>, <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code>) -&gt; <code><a href="https://rdrr.io/pkg/torch/man/dataloader.html" class="external-link">torch::dataloader</a></code><br>
Create a dataloader from the task.
Needs to respect at least <code>batch_size</code> and <code>shuffle</code> (otherwise predictions are permuted).</p></li>
</ul><p>While it is possible to add parameters by specifying the <code>param_set</code> construction argument, it is currently
not possible to remove existing parameters, i.e. those listed in section <em>Parameters</em>.
None of the parameters provided in <code>param_set</code> can have an id that starts with <code>"loss."</code>, <code>"opt.", or </code>"cb."`, as these are preserved for the dynamically constructed parameters of the optimizer, the loss function,
and the callbacks.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other Learner: 
<code><a href="mlr_learners_classif.alexnet.html">mlr_learners_classif.alexnet</a></code>,
<code><a href="mlr_learners_classif.mlp.html">mlr_learners_classif.mlp</a></code>,
<code><a href="mlr_learners_classif.torch_featureless.html">mlr_learners_classif.torch_featureless</a></code>,
<code><a href="mlr_learners_classif.torch_model.html">mlr_learners_classif.torch_model</a></code>,
<code><a href="mlr_learners_classif.torch.html">mlr_learners_classif.torch</a></code>,
<code><a href="mlr_learners_classif_torch_image.html">mlr_learners_classif_torch_image</a></code>,
<code><a href="mlr_learners_regr.mlp.html">mlr_learners_regr.mlp</a></code>,
<code><a href="mlr_learners_regr.torch_model.html">mlr_learners_regr.torch_model</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="super-classes">Super classes<a class="anchor" aria-label="anchor" href="#super-classes"></a></h2>
    <p><code><a href="https://mlr3.mlr-org.com/reference/Learner.html" class="external-link">mlr3::Learner</a></code> -&gt; <code><a href="https://mlr3.mlr-org.com/reference/LearnerRegr.html" class="external-link">mlr3::LearnerRegr</a></code> -&gt; <code>LearnerRegrTorch</code></p>
    </div>
    <div class="section level2">
    <h2 id="active-bindings">Active bindings<a class="anchor" aria-label="anchor" href="#active-bindings"></a></h2>
    <p></p><div class="r6-active-bindings"><dl><dt><code>network</code></dt>
<dd><p>(<code><a href="https://rdrr.io/pkg/torch/man/nn_module.html" class="external-link">nn_module()</a></code>)<br>
The network (only available after training).</p></dd>


<dt><code>param_set</code></dt>
<dd><p>(<code>ParamSet</code>)<br>
The parameter set</p></dd>


<dt><code>history</code></dt>
<dd><p>(<code><a href="mlr_callbacks_torch.history.html">CallbackTorchHistory</a></code>)<br>
Shortcut for <code>learner$model$callbacks$history</code>.</p></dd>


</dl><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>
    
<div class="section">
<h3 id="public-methods">Public methods<a class="anchor" aria-label="anchor" href="#public-methods"></a></h3>

<ul><li><p><a href="#method-LearnerRegrTorch-new"><code>LearnerRegrTorch$new()</code></a></p></li>
<li><p><a href="#method-LearnerRegrTorch-clone"><code>LearnerRegrTorch$clone()</code></a></p></li>
</ul></div><p><details><summary>Inherited methods</summary><ul><li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="base_learner"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-base_learner"><code>mlr3::Learner$base_learner()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="format"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-format"><code>mlr3::Learner$format()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="help"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-help"><code>mlr3::Learner$help()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="predict"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-predict"><code>mlr3::Learner$predict()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="predict_newdata"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-predict_newdata"><code>mlr3::Learner$predict_newdata()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="print"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-print"><code>mlr3::Learner$print()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="reset"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-reset"><code>mlr3::Learner$reset()</code></a></span></li>
<li><span class="pkg-link" data-pkg="mlr3" data-topic="Learner" data-id="train"><a href="https://mlr3.mlr-org.com/reference/Learner.html#method-train"><code>mlr3::Learner$train()</code></a></span></li>
</ul></details></p><hr><a id="method-LearnerRegrTorch-new"></a><div class="section">
<h3 id="method-new-">Method <code>new()</code><a class="anchor" aria-label="anchor" href="#method-new-"></a></h3>
<p>Creates a new instance of this <a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6</a> class.</p><div class="section">
<h4 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va"><a href="../reference/mlr_learners_regr.torch.html">LearnerRegrTorch</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span>  <span class="va">id</span>,</span>
<span>  <span class="va">optimizer</span>,</span>
<span>  <span class="va">loss</span>,</span>
<span>  <span class="va">param_set</span>,</span>
<span>  properties <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  packages <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">character</a></span><span class="op">(</span><span class="fl">0</span><span class="op">)</span>,</span>
<span>  predict_types <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  <span class="va">feature_types</span>,</span>
<span>  <span class="va">man</span>,</span>
<span>  <span class="va">label</span>,</span>
<span>  callbacks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h4>
<p></p><div class="arguments"><dl><dt><code>id</code></dt>
<dd><p>(<code>character(1)</code>)<br>
The id for of the new object.</p></dd>


<dt><code>optimizer</code></dt>
<dd><p>(<code><a href="TorchOptimizer.html">TorchOptimizer</a></code>)<br>
The torch optimizer.</p></dd>


<dt><code>loss</code></dt>
<dd><p>(<code><a href="TorchLoss.html">TorchLoss</a></code>)<br>
The loss used to train the network.</p></dd>


<dt><code>param_set</code></dt>
<dd><p>(<code><a href="https://paradox.mlr-org.com/reference/ParamSet.html" class="external-link">paradox::ParamSet</a></code>)<br>
The parameter set.</p></dd>


<dt><code>properties</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
The properties of the object.
See <code>mlr_reflections$learner_properties</code> for available values.</p></dd>


<dt><code>packages</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
The R packages this object depends on.</p></dd>


<dt><code>predict_types</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
The predict types.
See <code>mlr_reflections$learner_predict_types</code> for available values.</p></dd>


<dt><code>feature_types</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code>)<br>
The feature types.
See <code>mlr_reflections$task_feature_types</code> for available values.</p></dd>


<dt><code>man</code></dt>
<dd><p>(<code>character(1)</code>)<br>
String in the format <code>[pkg]::[topic]</code> pointing to a manual page for this object.
The referenced help package can be opened via method <code>$help()</code>.</p></dd>


<dt><code>label</code></dt>
<dd><p>(<code>character(1)</code>)<br>
Label for the new instance.</p></dd>


<dt><code>callbacks</code></dt>
<dd><p>(<code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> of <code><a href="TorchCallback.html">TorchCallback</a></code>s)<br>
The callbacks used during training.
Must have unique ids.
They are executed in the order in which they are provided</p></dd>


</dl><p></p></div>
</div>

</div><p></p><hr><a id="method-LearnerRegrTorch-clone"></a><div class="section">
<h3 id="method-clone-">Method <code>clone()</code><a class="anchor" aria-label="anchor" href="#method-clone-"></a></h3>
<p>The objects of this class are cloneable with this method.</p><div class="section">
<h4 id="usage-1">Usage<a class="anchor" aria-label="anchor" href="#usage-1"></a></h4>
<p></p><div class="r"><div class="sourceCode"><pre><code><span><span class="va">LearnerRegrTorch</span><span class="op">$</span><span class="fu">clone</span><span class="op">(</span>deep <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div><p></p></div>
</div>

<div class="section">
<h4 id="arguments-1">Arguments<a class="anchor" aria-label="anchor" href="#arguments-1"></a></h4>
<p></p><div class="arguments"><dl><dt><code>deep</code></dt>
<dd><p>Whether to make a deep clone.</p></dd>


</dl><p></p></div>
</div>

</div>

    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Sebastian Fischer, Lukas Burk, Martin Binder.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

