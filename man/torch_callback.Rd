% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/TorchCallback.R
\name{torch_callback}
\alias{torch_callback}
\title{Create a Torch Callback}
\usage{
torch_callback(
  id,
  classname = paste0("CallbackTorch", capitalize(id)),
  param_set = NULL,
  packages = NULL,
  label = capitalize(id),
  man = NULL,
  on_begin = NULL,
  on_end = NULL,
  on_epoch_begin = NULL,
  on_before_valid = NULL,
  on_epoch_end = NULL,
  on_batch_begin = NULL,
  on_batch_end = NULL,
  on_after_backward = NULL,
  on_batch_valid_begin = NULL,
  on_batch_valid_end = NULL,
  public = NULL,
  private = NULL,
  active = NULL,
  parent_env = parent.frame()
)
}
\arguments{
\item{id}{(\code{character(1)})\cr`\cr
The id for the callbacks.
Note that the ids of callbacks passed to a learner must be unique.}

\item{classname}{(\code{character(1)})\cr
The class name.}

\item{param_set}{(\code{ParamSet})\cr
The parameter set, if not present it is inferred from the initialize method passed through the public function.}

\item{packages}{(\code{character()})\cr\verb{The packages the callback depends on. Default is}NULL`.}

\item{label}{(\code{character(1)})\cr
Label for the new instance.}

\item{man}{(\code{character(1)})\cr
String in the format \verb{[pkg]::[topic]} pointing to a manual page for this object.
The referenced help package can be opened via method \verb{$help()}.}

\item{on_begin}{on_end, on_epoch_begin, on_before_valid, on_epoch_end, on_batch_begin, on_batch_end,
on_after_backward, on_batch_valid_begin, on_batch_valid_end (\code{function})\cr
Function to execute at the given stage, see section \emph{Stages}.}

\item{public}{private, active (\code{list()})\cr
Additional public, private, and active fields to add to the callback.}

\item{parent_env}{(\code{environment()})\cr
The parent environment for the \code{\link{R6Class}}.}
}
\value{
\code{\link{TorchCallback}}
}
\description{
Convenience function to create a custom callback for torch.
For more information on how to correctly implement a new callback, see \code{\link{CallbackTorch}}.
It returns a \code{\link{TorchCallback}} that wrapping a \code{\link{CallbackTorch}}.
}
\section{Internals}{

It first creates an \code{\link{R6ClassGenerator}} using \code{\link{torch_callback}}and when wraps this generator in a
\code{\link{TorchCallback}}.
}

\section{Stages}{

\itemize{
\item \code{begin} :: Run before the training loop begins.
\item \code{epoch_begin} :: Run he beginning of each epoch.
\item \code{before_validation} :: Run before each validation loop.
\item \code{batch_begin} :: Run before the forward call.
\item \code{after_backward} :: Run after the backward call.
\item \code{batch_end} :: Run after the optimizer step.
\item \code{batch_valid_begin} :: Run before the forward call in the validation loop.
\item \code{batch_valid_end} :: Run after the forward call in the validation loop.
\item \code{epoch_end} :: Run at the end of each epoch.
\item \code{end} :: Run at last, using \code{on.exit()}.
}
}

\examples{
custom_tcb = torch_callback(
  "mycallback",
  public = list(
    initialize = function(greeting) {
      self$greeting = greeting
    }
  ),
  on_begin = function(ctx) {
    cat(self$greeting, ctx$name, "\n")
  },
  on_end = function(ctx) {
    cat("Bye", ctx$name, "\n")
  }
)

custom_tcb$param_set$set_values(greeting = "Wazzuuup")

cb = custom_tcb$get_callback()

ctx = new.env()
ctx$name = "Albert"

f = function(ctx, cb) {
  cb$on_begin(ctx)
  catn("Doing heavy work ...")
  cb$on_end(ctx)
}

f(ctx, cb)
}
\seealso{
Other callback: 
\code{\link{as_torch_callbacks}()},
\code{\link{as_torch_callback}()},
\code{\link{callback_torch}()},
\code{\link{mlr3torch_callbacks.progress}},
\code{\link{mlr3torch_callbacks}},
\code{\link{mlr_callbacks_torch}},
\code{\link{mlr_context_torch}}
}
\concept{callback}
